core.CreateUUID=async()=>uuidv4(),core["HTMLView`TemplateProcessor"]=async(e,t)=>{const n=await interpretate(e[0],t);var a,r;t.htmlContent.text=(a=t.htmlContent.text,r=n,a.replace(/#(\w+)/g,(e,t)=>void 0!==r[t]?r[t]:e))},core["CoffeeLiqueur`Extensions`InputsOutputs`Tools`TemplateProcessor"]=core["HTMLView`TemplateProcessor"],core["HTMLView`WLXProcessor"]=async(e,t)=>{t.local.wlxEnvs=[];const n=t.htmlContent.text;t.htmlContent.function=async e=>{await window.SupportedCells.wlx.view.hydrate(n,t.local.wlxEnvs,e)}},core["HTMLView`WLXProcessor"].destroy=(e,t)=>{console.log("wlx processor disposed"),window.SupportedCells.wlx.view.dispose(t.local.wlxEnvs),delete t.local.wlxEnvs},core["HTMLView`WLXProcessor"].virtual=!0,core["CoffeeLiqueur`Extensions`InputsOutputs`Tools`WLXProcessor"]=core["HTMLView`WLXProcessor"],core["HTMLView`InlineJSModule"]=async(e,t)=>{let n=await interpretate(e[0],t);n.includes("<script>")&&(n=n.replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,""));const a=document.createElement("script");a.appendChild(document.createTextNode("{\n"+n+"\n}")),t.element.appendChild(a)},core["CoffeeLiqueur`Extensions`InputsOutputs`Tools`InlineJSModule"]=core["HTMLView`InlineJSModule"],core["CoffeeLiqueur`Extensions`InputsOutputs`Tools`AnonymousJavascript"]=core["HTMLView`InlineJSModule"],core.HTMLView=async(e,t)=>{let n=await interpretate(e[0],t);const a=await core._getRules(e,{...t,hold:!0});let r;Array.isArray(n)&&(n=n.join("\n")),t.htmlContent={text:n},"Prolog"in a&&await interpretate(a.Prolog,t),t.htmlContent.function?(await t.htmlContent.function(async e=>{r=await setInnerHTMLAsync(t.element,e)}),console.warn("Complex processing")):r=await setInnerHTMLAsync(t.element,t.htmlContent.text),"Epilog"in a&&(console.log("Epilog"),await interpretate(a.Epilog,{...t,element:r}))},core["CoffeeLiqueur`Extensions`InputsOutputs`HTMLView"]=core.HTMLView,core.Prolog=()=>"Prolog",core.Epilog=()=>"Epilog",core["CoffeeLiqueur`Extensions`InputsOutputs`Private`HandleGroup"]=async(e,t)=>{const n=await interpretate(e[0],{...t,hold:!0}),a=t.element.querySelectorAll('[data-type="group"]')[0];for(const e of n){const n=document.createElement("div");a.appendChild(n),await interpretate(e,{...t,element:n})}},core["Notebook`Kernel`Inputs`Private`HandleGroup"]=core["CoffeeLiqueur`Extensions`InputsOutputs`Private`HandleGroup"],core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementCallback"]=async(e,t)=>{const n=await interpretate(e[1],t),a=await interpretate(e[0],t);t.local.uid=a;const r=core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementCallback"][a];t.local.el=r,r&&r.init(n,t)},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementCallback"].update=async(e,t)=>{const n=await interpretate(e[1],t);t.local.el.update(n,t)},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementCallback"].destroy=(e,t)=>{console.log("InternalElementCallback destroyed!"),delete t.local.el,delete core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementCallback"][t.local.uid]},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementCallback"].virtual=!0,core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementUpdate"]=async(e,t)=>{const n=await interpretate(e[0],t),a=await interpretate(e[1],t),r=await interpretate(e[2],t);t.local.element=t.element.querySelectorAll(`[data-type="${a}"]`)[0],t.local.field=r,t.local.element[r]=n},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementUpdate"].update=async(e,t)=>{const n=await interpretate(e[0],t);t.local.element[t.local.field]=n},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementUpdate"].destroy=()=>{console.log("InternalElementUpdate destroyed!")},core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementUpdate"].virtual=!0,core["Notebook`Kernel`Inputs`Private`InternalElementUpdate"]=core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalElementUpdate"],core.InternalWLXDestructor=async(e,t)=>{const n=await interpretate(e[0],t);t.local.uid=n,console.log("Registered an instance")},core.InternalWLXDestructor.destroy=async(e,t)=>{console.log(t.local.uid),core.InternalWLXDestructor[t.local.uid]||core.InternalWLXDestructor[t.local.uid](t),console.log("Removed an instance")},core.InternalWLXDestructor.virtual=!0,core["CoffeeLiqueur`Extensions`InputsOutputs`Private`InternalWLXDestructor"]=core.InternalWLXDestructor,core.InternalHandleGroup=async(e,t)=>{const n=await interpretate(e[0],t),a=await interpretate(e[1],{...t,hold:!0}),r=document.getElementById(n);for(const e of a){const n=document.createElement("div");r.appendChild(n),await interpretate(e,{...t,element:n})}},core.InternalHandleTextView=async(e,t)=>{const n=await interpretate(e[0],t),a=await interpretate(e[1],t);t.local.element=document.getElementById(a),t.local.element.value=n},core.InternalHandleTextView.update=async(e,t)=>{const n=await interpretate(e[0],t);t.local.element.value=n},core.InternalHandleTextView.destroy=async(e,t)=>{console.log("InternalHandleTextView destroyed!")},core.InternalHandleTextView.virtual=!0,core.InternalHandleHTMLView=async(e,t)=>{const n=await interpretate(e[0],t),a=await interpretate(e[1],t);t.local.element=document.getElementById(a),t.local.element.innerHTML=n},core.InternalHandleHTMLView.update=async(e,t)=>{const n=await interpretate(e[0],t);t.local.element.innerHTML=n},core.InternalHandleHTMLView.destroy=async(e,t)=>{console.log("InternalHandleHTMLView destroyed!")},core.InternalHandleHTMLView.virtual=!0,window.base64ArrayBuffer=e=>{for(var t,n="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r=new Uint8Array(e),l=r.byteLength,i=l%3,s=l-i,o=0;o<s;o+=3)n+=a[(16515072&(t=r[o]<<16|r[o+1]<<8|r[o+2]))>>18]+a[(258048&t)>>12]+a[(4032&t)>>6]+a[63&t];return 1==i?n+=a[(252&(t=r[s]))>>2]+a[(3&t)<<4]+"==":2==i&&(n+=a[(64512&(t=r[s]<<8|r[s+1]))>>10]+a[(1008&t)>>4]+a[(15&t)<<2]+"="),n};const e={};function t(e){return e instanceof Element}const n={};n.MixedUnit=core.List,n.Power=(e,n)=>{const a=interpretate(e[0],n),r=interpretate(e[1],n),l=document.createElement("span"),i=document.createElement("sup");return t(a)?l.appendChild(a):l.innerText=a,t(a)?i.appendChild(r):i.innerText=r,l.appendChild(i),l},n.Times=(e,n)=>{const a=e.map(e=>interpretate(e,n)),r=document.createElement("span");return a.forEach((e,n)=>{if(t(e))r.appendChild(e);else{const t=document.createElement("text");t.innerText=e,r.appendChild(t)}if(n<a.length-1){const e=document.createElement("text");e.innerHTML="&middot;",r.appendChild(e)}}),r},e.Quantity=async(e,t,a)=>{if(a.classList.add("selectable"),"Association"==e[0]){const t=Object.keys(await interpretate(e,{hold:!0})),n=document.createElement("ul");for(const e of t){const t=document.createElement("li");t.innerText=e,n.appendChild(t)}n.style.maxHeight="4rem",a.style.overflowY="scroll",a.appendChild(n)}else if("Quantity"==e[0]){const r=await interpretate(e[1],t),l=await interpretate(e[2],{...t,context:n});l instanceof Element?(a.innerText=`${r} `,a.appendChild(l)):a.innerText=`${r} ${l}`}return!0},e.Entity=async(t,n,a,r)=>await e.Blank(t,n,a,r,interpretate.hashv2),e.DateObject=async(e,t,n)=>{const a=await interpretate(e[1],t),[r,l,i,s=0,o=0,c=0]=a,d=new Date(r??0,(l??1)-1,i??1,s,o,c);n.classList.add("text-xs","text-left","text-gray-800","selectable");const p=document.createElement("div");p.innerText=d.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),n.appendChild(p);const u=document.createElement("span");return u.innerText=d.toLocaleDateString(),n.appendChild(u),!0},e.Missing=async()=>!0,e.$Failed=async(e,t,n,a)=>(n.innerText="$Failed",!0),e.Graphics=async(e,t,n,a)=>{t.heavyLoad=!0;let r={global:{},element:n};console.log("frontend executable");const l=r,i=new ExecutableObject("dataset-stored-"+uuidv4(),l,e,!0);return i.assignScope(l),i.execute(),a.instances.push(i),!0},e.Graphics3D=e.Graphics,e.Image=e.Graphics,e.Image3D=e.Graphics,e.Sound=e.Graphics,e.FrontEndExecutable=e.Graphics,e.List=async(t,n,a,r,i)=>{const s=(n.reqursionDepth||1)+1;if(s>4)return a.innerText="...",!0;if(s>2){const l=document.createElement("button");return l.innerText="...",l.className="sm-controls rounded bg-white px-2 py-1 text-xs font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50",l.addEventListener("click",()=>{l.remove(),e.List(t,{...n,reqursionDepth:s-2},a,r,i)}),a.appendChild(l),!0}const o=document.createElement("div"),c=document.createElement("table");c.className="divide-y w-full divide-gray-200",c.style.textAlign="right",o.style.maxHeight="9rem",o.classList.add("overflow-y-scroll"),n.tableBorders&&(a.classList.add("ring-1","ring-inset","ring-gray-400"),o.style.margin="0.25rem");for(const e of t.slice(1)){const t=document.createElement("tr");t.className="px-2 py-1 whitespace-nowrap text-sm ";const a=document.createElement("td");t.appendChild(a),c.appendChild(t),await l(0,0,e,{...n,reqursionDepth:s,tableBorders:!0},a,r,i)}return o.appendChild(c),a.appendChild(o),!0},e.Association=async(t,n,a,r,s)=>{const o=(n.reqursionDepth||1)+1;if(o>4)return a.innerText="...",!0;if(o>2){const l=document.createElement("button");return l.innerText="...",l.className="sm-controls rounded bg-white px-2 py-1 text-xs font-semibold text-gray-900 ring-1 ring-inset ring-gray-300 hover:bg-gray-50",l.addEventListener("click",()=>{l.remove(),e.Association(t,{...n,reqursionDepth:o-2},a,r,s)}),a.appendChild(l),!0}const c=document.createElement("div"),d=document.createElement("table");d.className="divide-y w-full divide-gray-200",d.style.textAlign="right",c.style.maxHeight="8rem",c.classList.add("overflow-y-scroll"),n.tableBorders&&(a.classList.add("ring-1","ring-inset","ring-gray-400"),c.style.margin="0.25rem");const p=await interpretate(t,{...n,contenxt:i,hold:!0});for(const e of Object.keys(p)){const t=document.createElement("tr"),a=document.createElement("th"),i=document.createElement("td");t.appendChild(a),t.appendChild(i),a.classList.add(..."px-2 py-1 text-start font-medium text-gray-500 uppercase".split(" ")),a.innerText=String(e),await l(0,0,p[e],{...n,reqursionDepth:o},i,r,s),d.appendChild(t)}return c.appendChild(d),a.appendChild(c),!0},e.Blank=async(e,t,n,a,r=interpretate.hash)=>{t.heavyLoad=!0;let l=r||interpretate.hash;const i=String(l(e));let s,o;if(i in ObjectHashMap)s=ObjectHashMap[i];else{s=new ObjectStorage(i),s.doNotCollect=!0,a.objects.push(s);try{o=await s.get()}catch(t){console.warn("Creating FE object by id "+i),await server.kernel.io.fetch("CoffeeLiqueur`Extensions`InputsOutputs`Private`DatasetMakeBox",[JSON.stringify(e),i]),o=await s.get()}}o||(o=await s.get());let c={global:{},element:n};console.log("Dataset: creating an object"),console.log("frontend executable");const d=c,p=new ExecutableObject("dataset-stored-"+uuidv4(),d,o,!0);return p.assignScope(d),s.assign(p),p.execute(),a.instances.push(p),!0};const a=new RegExp(/^(-?\d+)(.?\d*)(\*\^)?(\d*)/),r=e=>{if("string"==typeof e){if("'"==e.charAt(0))return e.slice(1,-1);if(isNumeric(e))return parseInt(e);if(a.test(e)){console.log(e);let[t,n,r,l,i]=e.split(a);return n+="."===r?r+"0":r,l&&(n+="E"+i),console.log(n),parseFloat(n)}}return"number"==typeof e&&e},l=async(t,n,a,l,i,s,o)=>{let c=a;if(void 0===c)return;let d=r(c);if(d)return i.classList.add("selectable"),"string"==typeof d?(i.classList.remove("whitespace-nowrap"),i.style.color="var(--editor-key-string)"):i.style.color="var(--editor-key-literal)",void(i.innerText=d);if(!0===c)return void(i.innerText="✅");if(!1===c)return void(i.innerText="❌");if("object"!=typeof c||Array.isArray(c))r(c[0])&&c.unshift("List");else{c=["Association"];for(const e of Object.keys(a))c.push(["Rule","'"+String(e)+"'",a[e]])}const p=c[0];if(p in e){if(await e[p](c,l,i,s,o))return}await e.Blank(c,l,i,s,o)},i={};i.Entity=(e,t)=>{const n=e[e.length-1],a=r(n);return a?String(a):n.slice(1).map(r).join(" ")},i.Missing=(e,t)=>"Missing",i.$Failed=(e,t)=>"$Failed",i.Association=async function(e,t){let n={};if(t.hold){for(const a of e)if(a instanceof Array&&"Rule"===a[0]){let e=a[1];const l=r(e);e=e in i||e in core||l||Array.isArray(e)&&(e[0]in i||e[0]in core)?interpretate(e,{...t,hold:!1}):String(e),n[e]=a[2]}}else for(const a of e)if(a instanceof Array&&"Rule"===a[0]){let e=a[1];const l=r(e);e=e in i||e in core||l||Array.isArray(e)&&(e[0]in i||e[0]in core)?interpretate(e,{...t,hold:!1}):String(e),n[e]=await interpretate(a[2],t)}return n},core.Dataset=async(e,t)=>{const n=await core._getRules(e,t),a=await interpretate(e[0],{...t,hold:!0,context:i});let r,s,o=interpretate.hash;"V2"==t?.options?.HashFunction&&(o=interpretate.hashv2);let c=[];const d=async e=>{let a;return Array.isArray(e)?(await Promise.all(e.map(async(n,a)=>{"Association"!=n[0]&&"List"!=n[0]?e[a]=n:e[a]=await interpretate(n,{...t,hold:!0,contenxt:i})})),Array.isArray(e[0])?(n.TableHeadings&&(r=n.TableHeadings),a=await Promise.all(e.map(async e=>Promise.all(e.map(async e=>e))))):"object"!=typeof e[0]?a=e.map(e=>[e]):(r=Object.keys(e[0]),a=await Promise.all(e.map(async e=>Promise.all(r.map(async t=>e[t])))))):(s=Object.keys(e),a=await Promise.all(s.map(async n=>await interpretate(e[n],{...t,hold:!0,context:i}))),Array.isArray(a[0])?a=await Promise.all(a.map(async e=>Promise.all(e.map(async e=>e)))):(r=Object.keys(a[0]),a=await Promise.all(a.map(async e=>Promise.all(r.map(async t=>e[t])))))),a};if(Array.isArray(a))await Promise.all(a.map(async(e,n)=>{"Association"!=e[0]&&"List"!=e[0]?a[n]=e:a[n]=await interpretate(e,{...t,hold:!0,context:i})})),Array.isArray(a[0])?(n.TableHeadings&&(r=n.TableHeadings),c=await Promise.all(a.map(async e=>Promise.all(e.map(async e=>e))))):"object"!=typeof a[0]?c=a.map(e=>[e]):(r=Object.keys(a[0]),c=await Promise.all(a.map(async e=>Promise.all(r.map(async t=>e[t])))));else{s=Object.keys(a);let e=!1;c=await Promise.all(s.map(async n=>"Association"!=a[n][0]&&"List"!=a[n][0]?(console.log(a[n]),e=!0,a[n]):await interpretate(a[n],{...t,hold:!0,context:i}))),console.log(e),e&&(c=c.map(e=>[e])),Array.isArray(c[0])?c=await Promise.all(c.map(async e=>Promise.all(e.map(async e=>e)))):(r=Object.keys(c[0]),!function(e,t){if(e.length!==t.length)return!1;const n=new Map;for(const t of e)n.set(t,(n.get(t)||0)+1);for(const e of t){if(!n.has(e))return!1;if(n.set(e,n.get(e)-1),n.get(e)<0)return!1}return!0}(Object.keys(c[0]),Object.keys(c[1]))?(console.log("Different keys for associations! Fallback to a single dimension"),c=c.map(e=>[e]),e=!0,r=void 0):(e&&console.log("1D"),c=await Promise.all(c.map(async e=>Promise.all(r.map(async t=>e[t]))))))}const p=t.element;p.classList.add(..."sm-controls cursor-default rounded-md 0 py-1 pl-3 bg-gray-50 pr-2 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs".split(" "));const u=document.createElement("div");u.classList.add(..."-m-1.5 overflow-x-auto".split(" "));const m=document.createElement("div");m.classList.add(..."p-1.5 inline-block align-middle".split(" "));const y=document.createElement("div");y.classList.add("overflow-hidden");const h=document.createElement("table");h.classList.add(..."block max-h-60 overflow-y-scroll sc-b pr-2 divide-y divide-gray-200".split(" ")),h.style.wordBreak="normal",h.style.wordWrap="initial",h.style.resize="both",h.style.maxWidth=Math.max(window.innerWidth-200*window.devicePixelRatio,300)+"px";let g,f=!1;if(h.addEventListener("mousedown",()=>{f||(f=!0,h.style.height=h.clientHeight+"px",h.style.maxWidth="",h.classList.remove("max-h-60"),console.log("class removed"))}),n.ImageSize&&(Array.isArray(n.ImageSize)?("number"==typeof n.ImageSize[0]&&(h.style.width=n.ImageSize[0]+"px"),"number"==typeof n.ImageSize[1]&&(h.style.height=n.ImageSize[1]+"px")):"number"==typeof n.ImageSize&&(h.style.width=n.ImageSize+"px")),r){g=document.createElement("thead"),g.classList.add(..."sticky top-0 bg-gray-100".split(" "));const e=document.createElement("tr");if(g.appendChild(e),s){const t=document.createElement("th");t.classList.add(..."px-2 py-1 text-start text-xs font-medium text-gray-500 uppercase".split(" ")),e.appendChild(t)}r.forEach(t=>{const n=document.createElement("th");n.classList.add(..."px-2 py-1 text-start text-xs font-medium text-gray-500 uppercase".split(" ")),n.innerText=t,e.appendChild(n)})}const x=document.createElement("tbody");let w;x.classList.add(..."max-h-10 divide-y divide-gray-200".split(" "));const v={instances:[],objects:[]};t.local.store=v;let L=0,C=0,b=0,E=1,T=0,I=0;const H=50;let k=200;const M={};let P=Math.ceil(c.length/k);if(M.rebuild=(e,t=50)=>{v.instances.forEach(e=>e.dispose()),v.instances=[],w=void 0,x.replaceChildren(),M.update(e,t,I)},M.update=(e,t=50)=>{w||(w=new Array(t).fill(null)),M.operate(e,0,t,I*k,(e,t)=>{w[t]?x.replaceChild(e,w[t]):x.appendChild(e),w[t]=e})},M.extend=(e,t)=>{T+=t,M.operate(e,H+T-t,H+T,I*k,(e,t)=>{x.appendChild(e),w.push(e)})},M.operate=async(e,n,a,r,i)=>{for(let c=n;c<a&&c+r<e.length;++c){const n=document.createElement("tr");if(n.classList.add("hover:bg-gray-200"),s){const e=document.createElement("td");e.classList.add(..."px-2 py-1 whitespace-nowrap text-sm font-medium text-gray-800".split(" ")),e.innerText=s[c+r],n.appendChild(e)}for(let a=0;a<e[c+r].length;++a){const i=e[c+r][a],s=document.createElement("td");s.classList.add(..."px-2 py-1 whitespace-nowrap text-sm text-gray-800".split(" ")),await l(c+r,a,i,t,s,v,o),n.appendChild(s)}i(n,c)}},T=0,M.rebuild(c,H),u.appendChild(m),m.appendChild(y),y.appendChild(h),g&&h.appendChild(g),h.appendChild(x),P>1||t?.options?.Parts){const e=document.createElement("div");e.classList.add(..."py-1 border-solid items-center h-6 px-1 mb-1 w-full flex flex-row-reverse gap-x-2".split(" ")),e.style.borderTop="1px solid #999";const n=document.createElement("button");n.style.transform="rotate(180deg)",n.innerHTML='<svg class="w-3 h-3 text-gray-500 hover:text-gray-400" viewBox="0 0 24 24" fill="none" >\n<path fill-rule="evenodd" clip-rule="evenodd" d="M5.46484 3.92349C4.79896 3.5739 4 4.05683 4 4.80888V19.1911C4 19.9432 4.79896 20.4261 5.46483 20.0765L19.1622 12.8854C19.8758 12.5108 19.8758 11.4892 19.1622 11.1146L5.46484 3.92349ZM2 4.80888C2 2.55271 4.3969 1.10395 6.39451 2.15269L20.0919 9.34382C22.2326 10.4677 22.2325 13.5324 20.0919 14.6562L6.3945 21.8473C4.39689 22.8961 2 21.4473 2 19.1911V4.80888Z" fill="currentColor"/>\n</svg>';const a=document.createElement("button");a.innerHTML='<svg class="w-3 h-3 text-gray-500 hover:text-gray-400" viewBox="0 0 24 24" fill="none" >\n<path fill-rule="evenodd" clip-rule="evenodd" d="M18.3956 19.7691C19.0541 20.2687 20 19.799 20 18.9724L20 5.02764C20 4.20106 19.0541 3.73137 18.3956 4.23095L9.20476 11.2033C8.67727 11.6035 8.67727 12.3965 9.20476 12.7967L18.3956 19.7691ZM22 18.9724C22 21.4521 19.1624 22.8612 17.1868 21.3625L7.99598 14.3901C6.41353 13.1896 6.41353 10.8104 7.99599 9.60994L17.1868 2.63757C19.1624 1.13885 22 2.5479 22 5.02764L22 18.9724Z" fill="currentColor"/>\n<path d="M2 3C2 2.44772 2.44772 2 3 2C3.55228 2 4 2.44772 4 3V21C4 21.5523 3.55228 22 3 22C2.44772 22 2 21.5523 2 21V3Z" fill="currentColor"/>\n</svg>';const r=document.createElement("button");r.style.transform="rotate(180deg)",r.innerHTML=a.innerHTML;const l=document.createElement("button");l.innerHTML=n.innerHTML;const i=document.createElement("span");i.classList.add("mr-auto"),L=c.length,C=0;const s=e=>{const t=Math.min((e+1)*k+C,L);i.innerText=`${t}/${L}`};if(e.appendChild(r),e.appendChild(l),e.appendChild(n),e.appendChild(a),e.appendChild(i),t.options&&t.options.Parts){const n=document.createElement("span");n.innerText="Data is partially on Kernel",e.appendChild(n),L=t.options.Total,E=t.options.Parts,k=Math.min(k,c.length),t.local.callback=()=>{},t.local.event=t.options.RequestEvent,core[t.options.RequestCallback]=async e=>{const n=await interpretate(e[0],{...t,hold:!0});t.local.callback(n)}}s(0);let o=!1;a.addEventListener("click",()=>{o||(I=0,T=0,M.rebuild(c,H),s(I),h.scrollTop=0)}),r.addEventListener("click",()=>{o||(I=P-1,T=0,M.rebuild(c,H),s(I),h.scrollTop=h.scrollHeight-h.clientHeight-10)}),l.addEventListener("click",()=>{if(!o){if(I===P-1){if(b===E-1)return;return b+=1,C+=c.length,I=0,T=0,t.local.callback=async e=>{c=await d(e),P=Math.ceil(c.length/k),M.rebuild(c,H),s(I),h.scrollTop=0,o=!1},o=!0,void server.kernel.emitt(t.local.event,b+1)}I+=1,T=0,M.rebuild(c,H),s(I),h.scrollTop=0}}),n.addEventListener("click",()=>{if(!o){if(0===I){if(0===b)return;return b-=1,C-=c.length,I=0,T=0,t.local.callback=async e=>{c=await d(e),P=Math.ceil(c.length/k),M.rebuild(c,H),s(I),h.scrollTop=0,o=!1},o=!0,void server.kernel.emitt(t.local.event,b+1)}I-=1,T=0,M.rebuild(c,H),s(I),h.scrollTop=h.scrollHeight-h.clientHeight-10}}),u.appendChild(e)}h.addEventListener("scroll",()=>{if(h.scrollTop+h.clientHeight>=h.scrollHeight-10){if(T+H>=k)return;let e=20;e+T+H>=c.length&&(e=c.length-H-T),console.log("scroll overflow"),e>=0&&M.extend(c,e)}}),p.appendChild(u),t.local.container_1=u},core.Dataset.destroy=(e,t)=>{t.element.classList.remove(..."sm-controls cursor-default rounded-md 0 py-1 pl-3 bg-gray-50 pr-2 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs".split(" ")),t.local.container_1.remove(),t.local.store.instances.forEach(e=>{e.dispose()}),t.local.store.objects.forEach(e=>{e.doNotCollect=!1})},core.Dataset.virtual=!0,core.Missing=()=>{},core.TableHeadings=()=>"TableHeadings";const s=async(e,t)=>{let n=await interpretate(e[1],t);const a=async e=>{let n=e;for(let e=0;e<n.length;++e)n[e]=await interpretate(n[e],{...t,hold:!0});return n};let r=await a(await interpretate(e[0],{...t,hold:!0})),l=await interpretate(e[2],t);const i=await interpretate(e[3],t),s=await interpretate(e[4],t),o=await interpretate(e[5],t),d=await interpretate(e[6],t),p=r.length;r.length;const u=t.element;u.classList.add(..."sm-controls cursor-default rounded-md 0 py-1 pl-3 bg-gray-50 pr-2 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs".split(" "));const m=document.createElement("div");m.classList.add(..."-m-1.5 overflow-x-auto".split(" "));const y=document.createElement("div");y.classList.add(..."p-1.5 inline-block align-middle".split(" "));const h=document.createElement("div");h.classList.add("overflow-hidden");const g=document.createElement("table");g.classList.add(..."block max-h-60 overflow-y-scroll sc-b pr-2 divide-y divide-gray-200".split(" ")),g.style.wordBreak="normal",g.style.wordWrap="initial",g.style.resize="both",g.style.maxWidth=Math.max(window.innerWidth-200*window.devicePixelRatio,300)+"px";let f,x=!1;g.addEventListener("mousedown",()=>{x||(x=!0,g.style.height=g.clientHeight+"px",g.style.maxWidth="",g.classList.remove("max-h-60"),console.log("class removed"))}),f=document.createElement("thead"),f.classList.add(..."sticky top-0 bg-gray-100".split(" "));const w=document.createElement("tr");f.appendChild(w);{const e=document.createElement("th");e.classList.add(..."px-2 py-1 text-start text-xs font-medium text-gray-500 uppercase".split(" ")),e.innerText="/",w.appendChild(e)}l.forEach(e=>{const t=document.createElement("th");t.classList.add(..."px-2 py-1 text-start text-xs font-medium text-gray-500 uppercase".split(" ")),t.innerText=e,w.appendChild(t)});const v=document.createElement("tbody");let L;v.classList.add(..."max-h-10 divide-y divide-gray-200".split(" ")),m.appendChild(y),y.appendChild(h),h.appendChild(g),g.appendChild(f),g.appendChild(v);const C={instances:[],objects:[]};t.local.store=C;let b=0,E=0,T=0,I=1,H=0,k=0;const M=50;let P=200;const A={};let O=Math.ceil(r.length/P),S=String(o).length;A.rebuild=(e,t=50)=>{C.instances.forEach(e=>e.dispose()),C.instances=[],L=void 0,v.replaceChildren(),A.update(e,t,k)},A.update=(e,t=50)=>{L||(L=new Array(t).fill(null)),A.operate(e,0,t,k*P,(e,t)=>{L[t]?v.replaceChild(e,L[t]):v.appendChild(e),L[t]=e})},A.extend=(e,t)=>{H+=t,A.operate(e,M+H-t,M+H,k*P,(e,t)=>{v.appendChild(e),L.push(e)})},A.operate=async(e,a,r,l,i)=>{for(let s=a;s<r&&s+l<e.length;++s){const a=document.createElement("tr");a.classList.add("hover:bg-gray-200");const r=document.createElement("td");r.classList.add(..."px-2 py-1 text-start text-xs font-medium text-gray-500".split(" ")),r.innerText=String(s+l+1+T*p).padStart(S,"0"),a.appendChild(r);for(let r=0;r<e[s+l].length;++r){const i=e[s+l][r],o=document.createElement("td");o.classList.add(..."px-2 py-1 whitespace-nowrap text-sm text-gray-800".split(" ")),await c(s+l,r,i,t,o,C,n),a.appendChild(o)}i(a,s)}},H=0,A.rebuild(r,M);{const e=document.createElement("div");e.classList.add(..."py-1 border-solid items-center h-6 px-1 mb-1 w-full flex flex-row-reverse gap-x-2".split(" ")),e.style.borderTop="1px solid #999";const n=document.createElement("button");n.style.transform="rotate(180deg)",n.innerHTML='<svg class="w-3 h-3 text-gray-500 hover:text-gray-400" viewBox="0 0 24 24" fill="none" >\n<path fill-rule="evenodd" clip-rule="evenodd" d="M5.46484 3.92349C4.79896 3.5739 4 4.05683 4 4.80888V19.1911C4 19.9432 4.79896 20.4261 5.46483 20.0765L19.1622 12.8854C19.8758 12.5108 19.8758 11.4892 19.1622 11.1146L5.46484 3.92349ZM2 4.80888C2 2.55271 4.3969 1.10395 6.39451 2.15269L20.0919 9.34382C22.2326 10.4677 22.2325 13.5324 20.0919 14.6562L6.3945 21.8473C4.39689 22.8961 2 21.4473 2 19.1911V4.80888Z" fill="currentColor"/>\n</svg>';const l=document.createElement("button");l.innerHTML='<svg class="w-3 h-3 text-gray-500 hover:text-gray-400" viewBox="0 0 24 24" fill="none" >\n<path fill-rule="evenodd" clip-rule="evenodd" d="M18.3956 19.7691C19.0541 20.2687 20 19.799 20 18.9724L20 5.02764C20 4.20106 19.0541 3.73137 18.3956 4.23095L9.20476 11.2033C8.67727 11.6035 8.67727 12.3965 9.20476 12.7967L18.3956 19.7691ZM22 18.9724C22 21.4521 19.1624 22.8612 17.1868 21.3625L7.99598 14.3901C6.41353 13.1896 6.41353 10.8104 7.99599 9.60994L17.1868 2.63757C19.1624 1.13885 22 2.5479 22 5.02764L22 18.9724Z" fill="currentColor"/>\n<path d="M2 3C2 2.44772 2.44772 2 3 2C3.55228 2 4 2.44772 4 3V21C4 21.5523 3.55228 22 3 22C2.44772 22 2 21.5523 2 21V3Z" fill="currentColor"/>\n</svg>';const c=document.createElement("button");c.style.transform="rotate(180deg)",c.innerHTML=l.innerHTML;const p=document.createElement("button");p.innerHTML=n.innerHTML;const u=document.createElement("span");u.classList.add("mr-auto"),b=r.length,E=0,1==d&&(c.classList.add("hidden"),l.classList.add("hidden"),p.classList.add("hidden"),n.classList.add("hidden"));const y=e=>{const t=Math.min((e+1)*P+E,b);u.innerText=`${t}/${b}`};e.appendChild(c),e.appendChild(p),e.appendChild(n),e.appendChild(l),e.appendChild(u);const h=document.createElement("span");h.innerText="Data is on Kernel",e.appendChild(h),b=o,I=d,P=Math.min(P,r.length),t.local.callback=()=>{},t.local.event=s,core[i]=async e=>{const n=await interpretate(e[0],{...t,hold:!0});t.local.callback(n)},y(0);let f=!1;l.addEventListener("click",()=>{f||(k=0,H=0,A.rebuild(r,M),y(k),g.scrollTop=0)}),c.addEventListener("click",()=>{f||(k=O-1,H=0,A.rebuild(r,M),y(k),g.scrollTop=g.scrollHeight-g.clientHeight-10)}),p.addEventListener("click",()=>{if(!f){if(k===O-1){if(T===I-1)return;return T+=1,E+=r.length,k=0,H=0,t.local.callback=async e=>{r=await a(e),O=Math.ceil(r.length/P),A.rebuild(r,M),y(k),g.scrollTop=0,f=!1},f=!0,void server.kernel.io.fire(t.local.event,T+1)}k+=1,H=0,A.rebuild(r,M),y(k),g.scrollTop=0}}),n.addEventListener("click",()=>{if(!f){if(0===k){if(0===T)return;return T-=1,E-=r.length,k=0,H=0,t.local.callback=async e=>{r=await a(e),O=Math.ceil(r.length/P),A.rebuild(r,M),y(k),g.scrollTop=0,f=!1},f=!0,void server.kernel.io.fire(t.local.event,T+1)}k-=1,H=0,A.rebuild(r,M),y(k),g.scrollTop=g.scrollHeight-g.clientHeight-10}}),m.appendChild(e)}g.addEventListener("scroll",()=>{if(g.scrollTop+g.clientHeight>=g.scrollHeight-10){if(H+M>=P)return;let e=20;e+H+M>=r.length&&(e=r.length-M-H),console.log("scroll overflow"),e>=0&&A.extend(r,e)}}),u.appendChild(m),t.local.container_1=m};s.virtual=!0,s.destroy=(e,t)=>{t.element.classList.remove(..."sm-controls cursor-default rounded-md 0 py-1 pl-3 bg-gray-50 pr-2 text-left text-gray-500 ring-1 ring-inset ring-gray-400 text-xs".split(" ")),t.local.container_1.remove(),t.local.store.instances.forEach(e=>{e.dispose()}),t.local.store.objects.forEach(e=>{e.doNotCollect=!1})};const o={Boolean:async(e,t,n,a)=>{const r=await interpretate(t,n);e.innerText=r?"✅":"❌"},String:async(e,t,n,a)=>{e.classList.add("selectable"),e.style.color="var(--editor-key-string)";"string"==typeof await interpretate(t,n)&&(e.innerText=await interpretate(t,n))},Real:async(e,t,n,a)=>{e.classList.add("selectable"),e.style.color="var(--editor-key-literal)";const r=await interpretate(t,n);"number"==typeof r&&(e.innerText=r.toString())}};o.NumberExpression=o.Real,o.Real64=o.Real,o.Real32=o.Real,o.Integer64=async(e,t,n,a)=>{e.classList.add("selectable"),e.style.color="var(--editor-key-literal)";const r=await interpretate(t,n);"number"==typeof r&&(e.innerText=String(r))},o.InertExpression=async(t,n,a,r)=>{await e.Blank(n,a,t,r,interpretate.hashv2)};var c=async(t,n,a,r,l,i,s)=>{const c=s[n];switch(c[0]){case"Generic":await o[c[1]](l,a,r,i);break;case"Date":await e.DateObject(a,r,l);break;case"Quantity":await e.Quantity(a,r,l);break;case"ListVector":await e.List(a,r,l,i,interpretate.hashv2);break;default:await e.Blank(a,r,l,i,interpretate.hashv2)}};core["CoffeeLiqueur`Extensions`InputsOutputs`Private`tbView"]=s;
